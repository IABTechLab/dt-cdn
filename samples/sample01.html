<!DOCTYPE html>
<html>
<head>
	<meta charset="UTF-8" />
  	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
	<meta name="apple-mobile-web-app-capable" content="yes" />
	
	<title>Digitrust Sample top level page</title>
    <script src="../dist/digitrust.js"></script>
    <!--<script src="http://digitrust.s3.amazonaws.com/dev/v1/digitrust.min.js"></script>-->
    <!--<script src="//cdn.digitru.st/prod/v1/digitrust.js"></script>-->
    <script>
	// "digitrustIframe": "http://local.digitru.st/dist/dt.html"
	// "digitrustIframe": "http://cdn-staging.digitru.st/dist/dt.html"
        DigiTrust.initialize({
            member: 'example_member_id',
            site: 'example_site_id',
			logging: { level: "DEBUG", enable: true },
			environment: {
				urls: {
					"digitrustIframe": "http://local.digitru.st/dist/dt.html"
				},
				iframe: {
					postMessageOrigin: "http://local.digitru.st",
					timeoutDuration: (1000 * 60)
				}
			},
            adblocker: {
                logoSrc: 'http://i.imgur.com/xfgM1wq.png',
                logoText: 'The Seattle Times',
                pictureSrc: 'http://i.imgur.com/IP5RRah.png',
                blockContent: true,
                detection: true,
                unstyled: true,
                customCssPath: './custom-dt.css',
                detectedCallback: function () { console.log('Publisher executed custom code after adblock detection'); },
                //popupFontColor: 'white', // @todo add to GitHub spec
                //popupBackgroundColor: 'orange', // @todo add to GitHub spec
                //userMessage: "test message"
            },
            apps: {
                manifest: 'http://local.digitru.st/misc/manifest.json'
            }
        },
        function (digiTrustResult) {
            console.log("Digi sample callback", digiTrustResult);
			console.log('Digi value: ' + digiTrustResult.success);
            
            if (digiTrustResult.success){
				if(digiTrustResult.identity.id != null) {
					DigiTrustCrypto.decrypt(digiTrustResult.identity.id, function(decryptedId) {
						console.log(decryptedId);
					});
				}
				else{
					console.error('Digitrust gave success, but no identity returned');
				}
            }
			else{
				console.log('Digitrust init failed');
			}
			
        });
        // var json = DigiTrust.getUser({member: ''});
        // console.log(json);
        /*var json = DigiTrust.getUser({member: '3rd_party_id'}, function (digiTrustResult) {
            console.log('3rd party getUser result', digiTrustResult);
            if (digiTrustResult.identity.id) {
                DigiTrustCrypto.decrypt(digiTrustResult.identity.id, function(decryptedId) {
                    console.log(decryptedId);
                })
            }
        });*/
    </script>
</head>
<body>
	<h1>Digitrust Publisher Sample</h1>
	
	<p>
		This page demonstrates how to integrate the Digitrust framework into a publisher site.
	</p>
	
    plain text.
    <h1>Great news</h1>
    <h2>This is something you are reading.</h2>
    <a href="http://www.seattletimes.com/life/food-drink/5-ways-caliburger-is-better-than-in-n-out/">
        Link external
    </a>
    <br/><br/><br/>
    <a href="javascript:void(0)" onclick="window.DigiTrust.sendReset()"> clear cookie</a>
    <br/><br/><br/>
    <a href="page2.html"> Link internal: page.html</a>
    <br/><br/><br/>
    <a href="./page2.html"> Link internal: ./page.html</a>
    <br/><br/><br/>
    <a href="/misc/page2.html"> Link internal: /misc/page.html</a>
    <br/><br/><br/>
    <a href="#foobar"> Link internal: #foobar</a>
    <br/><br/><br/>
    This is just.
    <div>A test.</div>
    <br/>
    <br/>
    <br/>
    <br/>
    <div>A test.</div>
    <br/>
    <br/>
    <br/>
    <br/>
    <div>A test.</div>
    <br/>
    <br/>
    <br/>
    <br/>
    <div>A test.</div>
    <br/>
    <br/>
    <br/>
    <br/>
    <div>A test.</div>
    <br/>
    <br/>
    <br/>
    <br/>
    <div>A test.</div>
    <br/>
    <br/>
    <br/>
    <br/>
    <div>A test.</div>
    <br/>
    <br/>
    <br/>
    <br/>
    <div>A test.</div>
    <br/>
    <br/>
    <br/>
    <br/>
</body>
</html>